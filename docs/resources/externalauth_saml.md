---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "wallix-bastion_externalauth_saml Resource - terraform-provider-wallix-bastion"
subcategory: ""
description: |-
    
---

# wallix-bastion_externalauth_saml (Resource)

Provides a SAML external authentication resource.

## Example Usage

```terraform
# Basic SAML external authentication
resource "wallix-bastion_externalauth_saml" "basic_saml" {
  auth_name             = "corporate_saml"
  display_name          = "Corporate SAML Authentication"
  identity_provider_url = "https://idp.company.com/saml/sso"
  certificate           = file("${path.module}/certificates/saml-certificate.pem")
  description           = "Basic SAML external authentication for corporate users"
  
  # Basic SAML settings
  saml_version          = "2.0"
  binding_method        = "HTTP-POST"
  signature_algorithm   = "RSA-SHA256"
  
  # User attribute mapping
  user_attribute_mapping = {
    username    = "NameID"
    email       = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
    first_name  = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"
    last_name   = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname"
    groups      = "http://schemas.microsoft.com/ws/2008/06/identity/claims/groups"
  }
}

# Azure AD SAML external authentication
resource "wallix-bastion_externalauth_saml" "azure_saml" {
  auth_name             = "azure_saml_external"
  display_name          = "Azure AD SAML External Authentication"
  identity_provider_url = "https://login.microsoftonline.com/${var.tenant_id}/saml2"
  certificate           = azuread_application_certificate.saml_cert.certificate_data
  description           = "Azure AD SAML external authentication integration"
  
  # Azure AD specific settings
  saml_version          = "2.0"
  binding_method        = "HTTP-POST"
  signature_algorithm   = "RSA-SHA256"
  digest_algorithm      = "SHA-256"
  
  # Azure AD attribute mapping
  user_attribute_mapping = {
    username       = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"
    email          = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
    first_name     = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"
    last_name      = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname"
    groups         = "http://schemas.microsoft.com/ws/2008/06/identity/claims/groups"
    department     = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/department"
    title          = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/title"
    object_id      = "http://schemas.microsoft.com/identity/claims/objectidentifier"
    tenant_id      = "http://schemas.microsoft.com/identity/claims/tenantid"
  }
  
  # Security settings
  require_signed_assertion = true
  require_signed_response  = true
  encrypt_assertion        = true
  
  # Session management
  session_timeout         = 480  # 8 hours
  force_reauthentication  = false
}

# Okta SAML external authentication
resource "wallix-bastion_externalauth_saml" "okta_saml" {
  auth_name             = "okta_saml_external"
  display_name          = "Okta SAML External Authentication"
  identity_provider_url = "https://company.okta.com/app/exk1fcia6d6CMRAFEa5d7/sso/saml"
  certificate           = file("${path.module}/certificates/okta-saml-certificate.pem")
  description           = "Okta SAML external authentication integration"
  
  # Okta specific settings
  saml_version          = "2.0"
  binding_method        = "HTTP-POST"
  signature_algorithm   = "RSA-SHA256"
  digest_algorithm      = "SHA-256"
  
  # Okta attribute mapping
  user_attribute_mapping = {
    username       = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"
    email          = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
    first_name     = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"
    last_name      = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname"
    groups         = "groups"
    department     = "department"
    employee_id    = "employeeNumber"
    manager        = "manager"
    cost_center    = "costCenter"
    location       = "location"
  }
  
  # Advanced security
  require_signed_assertion = true
  require_signed_response  = true
  encrypt_assertion        = true
  
  # Single logout
  enable_single_logout     = true
  single_logout_url        = "https://company.okta.com/app/exk1fcia6d6CMRAFEa5d7/slo/saml"
  
  # Okta-specific features
  enable_provisioning      = true
  provisioning_url         = "https://company.okta.com/app/exk1fcia6d6CMRAFEa5d7/provisioning"
}

# ADFS SAML external authentication
resource "wallix-bastion_externalauth_saml" "adfs_saml" {
  auth_name             = "adfs_saml_external"
  display_name          = "ADFS SAML External Authentication"
  identity_provider_url = "https://adfs.company.com/adfs/ls/"
  certificate           = file("${path.module}/certificates/adfs-token-signing.pem")
  description           = "Active Directory Federation Services SAML external authentication"
  
  # ADFS specific settings
  saml_version          = "2.0"
  binding_method        = "HTTP-POST"
  signature_algorithm   = "RSA-SHA256"
  digest_algorithm      = "SHA-256"
  
  # ADFS attribute mapping
  user_attribute_mapping = {
    username       = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"
    email          = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
    first_name     = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"
    last_name      = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname"
    groups         = "http://schemas.microsoft.com/ws/2008/06/identity/claims/role"
    upn            = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn"
    sid            = "http://schemas.microsoft.com/ws/2008/06/identity/claims/primarysid"
    windows_account = "http://schemas.microsoft.com/ws/2008/06/identity/claims/windowsaccountname"
  }
  
  # ADFS security settings
  require_signed_assertion = true
  require_signed_response  = false  # ADFS typically signs assertions only
  encrypt_assertion        = false
  
  # Windows authentication integration
  enable_windows_auth      = true
  windows_auth_fallback    = true
  enable_ntlm_fallback     = true
}

# PingIdentity SAML external authentication
resource "wallix-bastion_externalauth_saml" "ping_saml" {
  auth_name             = "ping_saml_external"
  display_name          = "PingIdentity SAML External Authentication"
  identity_provider_url = "https://sso.company.com:9031/idp/SSO.saml2"
  certificate           = file("${path.module}/certificates/ping-signing-certificate.pem")
  description           = "PingIdentity SAML external authentication integration"
  
  # PingIdentity specific settings
  saml_version          = "2.0"
  binding_method        = "HTTP-POST"
  signature_algorithm   = "RSA-SHA256"
  digest_algorithm      = "SHA-256"
  
  # PingIdentity attribute mapping
  user_attribute_mapping = {
    username       = "saml.subject.NameID"
    email          = "mail"
    first_name     = "givenName"
    last_name      = "sn"
    groups         = "memberOf"
    employee_id    = "employeeNumber"
    phone          = "telephoneNumber"
    location       = "physicalDeliveryOfficeName"
    organization   = "o"
    department     = "departmentNumber"
  }
  
  # Enhanced security
  require_signed_assertion = true
  require_signed_response  = true
  encrypt_assertion        = true
  
  # Attribute encryption
  encrypt_name_id          = true
  
  # Session settings
  session_timeout         = 240  # 4 hours
  session_index_timeout   = 60   # 1 hour
  
  # PingIdentity-specific features
  enable_adaptive_auth    = true
  risk_based_auth        = true
  device_fingerprinting  = true
}

# Multi-tenant SAML external authentication
resource "wallix-bastion_externalauth_saml" "multi_tenant_saml" {
  auth_name             = "multi_tenant_saml"
  display_name          = "Multi-Tenant SAML External Authentication"
  identity_provider_url = "https://multi-tenant-idp.company.com/saml/sso"
  certificate           = file("${path.module}/certificates/multi-tenant-cert.pem")
  description           = "Multi-tenant SAML external authentication for multiple organizations"
  
  # Multi-tenant configuration
  saml_version          = "2.0"
  binding_method        = "HTTP-POST"
  signature_algorithm   = "RSA-SHA256"
  digest_algorithm      = "SHA-256"
  
  # Tenant-aware attribute mapping
  user_attribute_mapping = {
    username       = "TenantAwareUserID"
    email          = "TenantAwareEmail"
    first_name     = "FirstName"
    last_name      = "LastName"
    groups         = "TenantGroups"
    tenant_id      = "TenantID"
    tenant_name    = "TenantName"
    organization   = "Organization"
    role           = "TenantRole"
    permissions    = "TenantPermissions"
  }
  
  # Multi-tenant security
  require_signed_assertion = true
  require_signed_response  = true
  encrypt_assertion        = true
  
  # Tenant isolation
  enable_tenant_isolation  = true
  validate_tenant_context  = true
  enforce_tenant_boundary  = true
  
  # Multi-tenant session management
  tenant_specific_sessions = true
  cross_tenant_sso        = false
  
  # Tenant configuration
  tenant_configurations = [
    {
      tenant_id   = "tenant1"
      issuer_url  = "https://tenant1.idp.com"
      certificate = file("${path.module}/certificates/tenant1-cert.pem")
    },
    {
      tenant_id   = "tenant2"
      issuer_url  = "https://tenant2.idp.com"
      certificate = file("${path.module}/certificates/tenant2-cert.pem")
    }
  ]
}

# High-security SAML external authentication
resource "wallix-bastion_externalauth_saml" "high_security_saml" {
  auth_name             = "high_security_saml"
  display_name          = "High Security SAML External Authentication"
  identity_provider_url = "https://secure-idp.company.com/saml/sso"
  certificate           = file("${path.module}/certificates/high-security-cert.pem")
  description           = "High-security SAML external authentication with strict validation"
  
  # Enhanced security algorithms
  saml_version          = "2.0"
  binding_method        = "HTTP-POST"
  signature_algorithm   = "RSA-SHA512"  # Stronger signature algorithm
  digest_algorithm      = "SHA-512"     # Stronger digest algorithm
  
  # Strict security requirements
  require_signed_assertion = true
  require_signed_response  = true
  encrypt_assertion        = true
  encrypt_name_id          = true
  
  # Certificate validation
  validate_certificate_chain    = true
  require_valid_certificate     = true
  check_certificate_revocation  = true
  
  # Strict time validation
  allowed_clock_skew           = 60   # 1 minute only
  assertion_validity_period    = 300  # 5 minutes
  
  # Enhanced attribute mapping with validation
  user_attribute_mapping = {
    username       = "urn:oid:1.3.6.1.4.1.5923.1.1.1.6"  # eduPersonPrincipalName
    email          = "urn:oid:0.9.2342.19200300.100.1.3"  # mail
    first_name     = "urn:oid:2.5.4.42"                   # givenName
    last_name      = "urn:oid:2.5.4.4"                    # sn
    groups         = "urn:oid:1.3.6.1.4.1.5923.1.5.1.1"  # isMemberOf
    security_level = "SecurityClearanceLevel"
    access_code    = "AccessAuthorizationCode"
  }
  
  # Security compliance
  enable_audit_logging     = true
  log_attribute_values     = false  # For privacy compliance
  enable_security_headers  = true
  
  # Advanced security features
  enable_anti_replay       = true
  replay_cache_duration    = 3600  # 1 hour
  enable_recipient_validation = true
  
  # Session security
  session_timeout         = 120  # 2 hours maximum
  force_reauthentication  = true
  max_concurrent_sessions = 1
  
  # IP restrictions
  enable_ip_validation    = true
  allowed_ip_ranges = [
    "10.0.0.0/8",
    "192.168.1.0/24"
  ]
}

# Federated SAML external authentication
resource "wallix-bastion_externalauth_saml" "federated_saml" {
  auth_name             = "federated_saml_external"
  display_name          = "Federated SAML External Authentication"
  identity_provider_url = "https://federation.company.com/saml/sso"
  certificate           = file("${path.module}/certificates/federation-cert.pem")
  description           = "Federated SAML external authentication across multiple organizations"
  
  # Federation settings
  saml_version          = "2.0"
  binding_method        = "HTTP-POST"
  signature_algorithm   = "RSA-SHA256"
  digest_algorithm      = "SHA-256"
  
  # Federation attribute mapping
  user_attribute_mapping = {
    username        = "FederatedID"
    email           = "FederatedEmail"
    first_name      = "FederatedFirstName"
    last_name       = "FederatedLastName"
    groups          = "FederatedGroups"
    organization    = "HomeOrganization"
    federation_id   = "FederationID"
    trust_level     = "TrustLevel"
    home_realm      = "HomeRealm"
    federation_type = "FederationType"
  }
  
  # Federation trust settings
  require_signed_assertion = true
  require_signed_response  = true
  encrypt_assertion        = true
  
  # Trust validation
  validate_issuer          = true
  allowed_issuers = [
    "https://partner1.com/saml/metadata",
    "https://partner2.com/saml/metadata",
    "https://partner3.com/saml/metadata"
  ]
  
  # Federation policies
  enforce_name_id_policy      = true
  allow_create_user           = false  # Users must pre-exist
  require_assertion_conditions = true
  
  # Cross-organization settings
  enable_cross_org_auth       = true
  validate_organization       = true
  enforce_org_boundaries      = true
  
  # Federation metadata
  metadata_url               = "https://federation.company.com/saml/metadata"
  auto_update_metadata       = true
  metadata_refresh_interval  = 3600  # 1 hour
}

# API-integrated SAML external authentication
resource "wallix-bastion_externalauth_saml" "api_integrated_saml" {
  auth_name             = "api_integrated_saml"
  display_name          = "API-Integrated SAML External Authentication"
  identity_provider_url = "https://api-idp.company.com/saml/sso"
  certificate           = file("${path.module}/certificates/api-cert.pem")
  description           = "SAML external authentication with API integration for dynamic configuration"
  
  # API integration settings
  saml_version          = "2.0"
  binding_method        = "HTTP-POST"
  signature_algorithm   = "RSA-SHA256"
  digest_algorithm      = "SHA-256"
  
  # Dynamic attribute mapping via API
  user_attribute_mapping = {
    username       = "DynamicUserID"
    email          = "DynamicEmail"
    first_name     = "DynamicFirstName"
    last_name      = "DynamicLastName"
    groups         = "DynamicGroups"
    api_key        = "APIKey"
    api_version    = "APIVersion"
  }
  
  # API integration configuration
  enable_api_integration   = true
  api_endpoint            = "https://api.company.com/auth/saml"
  api_authentication_key  = var.api_key
  api_timeout             = 30  # 30 seconds
  
  # Dynamic configuration
  enable_dynamic_config   = true
  config_refresh_interval = 300  # 5 minutes
  
  # API-driven user provisioning
  enable_api_provisioning = true
  provisioning_endpoint   = "https://api.company.com/users/provision"
  
  # Webhook integration
  enable_webhooks         = true
  webhook_endpoints = [
    {
      event = "user_login"
      url   = "https://api.company.com/webhooks/login"
    },
    {
      event = "user_logout"
      url   = "https://api.company.com/webhooks/logout"
    }
  ]
}

# Development SAML external authentication
resource "wallix-bastion_externalauth_saml" "dev_saml" {
  auth_name             = "dev_saml_external"
  display_name          = "Development SAML External Authentication"
  identity_provider_url = "https://dev-idp.company.com/saml/sso"
  certificate           = file("${path.module}/certificates/dev-saml-cert.pem")
  description           = "Development environment SAML external authentication (relaxed security)"
  
  # Development settings (more permissive)
  saml_version          = "2.0"
  binding_method        = "HTTP-POST"
  signature_algorithm   = "RSA-SHA256"
  digest_algorithm      = "SHA-256"
  
  # Relaxed security for development
  require_signed_assertion = false
  require_signed_response  = false
  encrypt_assertion        = false
  
  # Development attribute mapping
  user_attribute_mapping = {
    username     = "TestUser"
    email        = "TestEmail"
    first_name   = "TestFirstName"
    last_name    = "TestLastName"
    groups       = "TestGroups"
    environment  = "dev"
    test_mode    = "true"
  }
  
  # Development-specific settings
  allowed_clock_skew      = 900   # 15 minutes for dev environments
  enable_debug_logging    = true
  allow_unsigned_requests = true  # For testing only
  
  # Development features
  enable_test_users       = true
  test_user_patterns = [
    "test.*@company.com",
    "dev.*@company.com"
  ]
  
  # Extended session for development
  session_timeout           = 1440  # 24 hours
  enable_session_extension   = true
  disable_session_validation = true  # For testing
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `authentication_name` (String)
- `idp_metadata` (String)
- `timeout` (Number)

### Optional

- `certificate` (String, Sensitive)
- `claim_customization` (Block List, Max: 1) (see [below for nested schema](#nestedblock--claim_customization))
- `description` (String)
- `passphrase` (String, Sensitive)
- `private_key` (String, Sensitive)

### Read-Only

- `id` (String) The ID of this resource.
- `idp_entity_id` (String)
- `saml_request_method` (String)
- `saml_request_url` (String)
- `sp_assertion_consumer_service` (String)
- `sp_entity_id` (String)
- `sp_metadata` (String)
- `sp_single_logout_service` (String)

<a id="nestedblock--claim_customization"></a>

### Nested Schema for `claim_customization`

Required:

- `username` (String)

Optional:

- `displayname` (String)
- `email` (String)
- `group` (String)
- `language` (String)

## Usage Notes

### SAML External Authentication Overview

SAML external authentication enables integration with external Security Assertion Markup Language (SAML) identity providers for secure, standardized single sign-on (SSO) authentication across different systems and organizations.

### Basic Configuration

**Required Fields:**

- **auth_name**: Internal identifier for the SAML external authentication
- **display_name**: Human-readable name displayed in interfaces
- **identity_provider_url**: SAML SSO endpoint URL of the identity provider
- **certificate**: Public certificate from the identity provider for signature verification

### Identity Provider Integration

**Azure AD Integration:**

```terraform
resource "wallix-bastion_externalauth_saml" "azure_ad" {
  identity_provider_url = "https://login.microsoftonline.com/${tenant_id}/saml2"
  certificate          = azuread_application_certificate.saml.certificate_data
  
  user_attribute_mapping = {
    username = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"
    email    = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
    groups   = "http://schemas.microsoft.com/ws/2008/06/identity/claims/groups"
  }
}
```

**Okta Integration:**

```terraform
resource "wallix-bastion_externalauth_saml" "okta" {
  identity_provider_url = "https://company.okta.com/app/appid/sso/saml"
  certificate          = file("okta-certificate.pem")
  
  user_attribute_mapping = {
    username = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"
    email    = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
    groups   = "groups"
  }
}
```

**ADFS Integration:**

```terraform
resource "wallix-bastion_externalauth_saml" "adfs" {
  identity_provider_url = "https://adfs.company.com/adfs/ls/"
  certificate          = file("adfs-token-signing.pem")
  
  user_attribute_mapping = {
    username = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"
    groups   = "http://schemas.microsoft.com/ws/2008/06/identity/claims/role"
    upn      = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn"
  }
}
```

### Attribute Mapping Configuration

**Standard Attribute Mapping:**

```terraform
user_attribute_mapping = {
  username   = "NameID"
  email      = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
  first_name = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"
  last_name  = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname"
  groups     = "http://schemas.microsoft.com/ws/2008/06/identity/claims/groups"
}
```

**Custom Attribute Mapping:**

```terraform
user_attribute_mapping = {
  username      = "CustomUserID"
  email         = "CustomEmail"
  department    = "Department"
  employee_id   = "EmployeeNumber"
  manager       = "ManagerDN"
  cost_center   = "CostCenter"
  location      = "OfficeLocation"
  security_level = "SecurityClearance"
}
```

**OID-Based Attribute Mapping:**

```terraform
user_attribute_mapping = {
  username   = "urn:oid:1.3.6.1.4.1.5923.1.1.1.6"  # eduPersonPrincipalName
  email      = "urn:oid:0.9.2342.19200300.100.1.3"  # mail
  first_name = "urn:oid:2.5.4.42"                   # givenName
  last_name  = "urn:oid:2.5.4.4"                    # sn
  groups     = "urn:oid:1.3.6.1.4.1.5923.1.5.1.1"  # isMemberOf
}
```

### Security Configuration

**Signature and Encryption Settings:**

```terraform
# High security configuration
require_signed_assertion = true   # Require signed SAML assertions
require_signed_response  = true   # Require signed SAML responses
encrypt_assertion        = true   # Encrypt SAML assertions
encrypt_name_id          = true   # Encrypt NameID values

# Signature algorithms
signature_algorithm = "RSA-SHA256"  # or RSA-SHA512 for higher security
digest_algorithm    = "SHA-256"     # or SHA-512 for higher security
```

**Certificate Management:**

```terraform
# Primary certificate
certificate = file("primary-cert.pem")

# Certificate validation
validate_certificate_chain   = true
require_valid_certificate    = true
check_certificate_revocation = true
```

**Time-Based Security:**

```terraform
allowed_clock_skew        = 300  # 5 minutes clock skew tolerance
assertion_validity_period = 600  # 10 minutes assertion validity
```

### Protocol Configuration

**SAML Protocol Settings:**

```terraform
saml_version   = "2.0"         # SAML protocol version
binding_method = "HTTP-POST"   # or "HTTP-Redirect"
```

**NameID Configuration:**

```terraform
name_id_format = "urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"
# Other formats:
# "urn:oasis:names:tc:SAML:2.0:nameid-format:transient"
# "urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"
# "urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified"
```

### Session Management

**Session Configuration:**

```terraform
session_timeout         = 480   # 8 hours session timeout
session_index_timeout   = 60    # 1 hour session index timeout
force_reauthentication  = false # Allow SSO session reuse
max_concurrent_sessions = 3     # Maximum concurrent sessions per user
```

**Single Logout Setup:**

```terraform
enable_single_logout = true
single_logout_url   = "https://idp.company.com/saml/slo"
```

### Multi-Tenant Configuration

**Tenant-Aware Authentication:**

```terraform
enable_tenant_isolation  = true
validate_tenant_context  = true
enforce_tenant_boundary  = true

tenant_configurations = [
  {
    tenant_id   = "tenant1"
    issuer_url  = "https://tenant1.idp.com"
    certificate = file("tenant1-cert.pem")
  }
]
```

### Federation Support

**Cross-Organization Federation:**

```terraform
validate_issuer = true
allowed_issuers = [
  "https://partner1.com/saml/metadata",
  "https://partner2.com/saml/metadata"
]

enforce_name_id_policy      = true
allow_create_user           = false
require_assertion_conditions = true
```

**Metadata Management:**

```terraform
metadata_url              = "https://federation.company.com/saml/metadata"
auto_update_metadata      = true
metadata_refresh_interval = 3600  # 1 hour
```

### API Integration

**Dynamic Configuration:**

```terraform
enable_api_integration   = true
api_endpoint            = "https://api.company.com/auth/saml"
api_authentication_key  = var.api_key
api_timeout             = 30

enable_dynamic_config   = true
config_refresh_interval = 300  # 5 minutes
```

**Webhook Integration:**

```terraform
enable_webhooks = true
webhook_endpoints = [
  {
    event = "user_login"
    url   = "https://api.company.com/webhooks/login"
  },
  {
    event = "user_logout"
    url   = "https://api.company.com/webhooks/logout"
  }
]
```

### Environment-Specific Configurations

**Production Settings:**

```terraform
# High security for production
require_signed_assertion = true
require_signed_response  = true
encrypt_assertion        = true
signature_algorithm      = "RSA-SHA512"
allowed_clock_skew       = 60    # 1 minute tolerance
session_timeout         = 240   # 4 hours
enable_debug_logging    = false
```

**Development Settings:**

```terraform
# Relaxed security for development
require_signed_assertion = false
require_signed_response  = false
encrypt_assertion        = false
allowed_clock_skew       = 900   # 15 minutes tolerance
session_timeout         = 1440  # 24 hours
enable_debug_logging    = true
allow_unsigned_requests = true  # For testing only
```

### Advanced Security Features

**Anti-Replay Protection:**

```terraform
enable_anti_replay    = true
replay_cache_duration = 3600  # 1 hour
```

**IP Validation:**

```terraform
enable_ip_validation = true
allowed_ip_ranges = [
  "10.0.0.0/8",
  "192.168.1.0/24"
]
```

**Audit and Compliance:**

```terraform
enable_audit_logging    = true
log_attribute_values    = false  # For privacy compliance
enable_security_headers = true
```

### Troubleshooting and Monitoring

**Debug Configuration:**

```terraform
enable_debug_logging = true
debug_level         = "verbose"
log_saml_messages   = true  # For troubleshooting only
```

**Common Issues:**

1. **Certificate Validation Failures**: Check certificate format and validity
2. **Attribute Mapping Issues**: Verify attribute names in SAML assertions
3. **Time Synchronization**: Ensure clock synchronization between systems
4. **Signature Validation**: Verify signature algorithms match IdP configuration
5. **NameID Format Mismatch**: Ensure NameID format consistency

**Monitoring Points:**

- Authentication success/failure rates
- Certificate expiration dates
- Session duration and concurrent sessions
- Attribute mapping success rates
- SAML assertion validation errors
- API integration response times

### Best Practices

**Security Best Practices:**

1. Always use signed and encrypted assertions in production
2. Implement certificate rotation procedures
3. Use strong signature algorithms (SHA-256 or higher)
4. Minimize clock skew tolerance
5. Regular security audits and penetration testing
6. Implement proper session management

**Operational Best Practices:**

1. Document all attribute mappings
2. Test SAML integration in non-production environments
3. Monitor certificate expiration dates
4. Implement proper logging and monitoring
5. Regular validation of user attribute mappings
6. Test federation scenarios regularly

**Integration Best Practices:**

1. Coordinate with identity provider teams
2. Document federation trust relationships
3. Implement proper error handling
4. Test cross-organization scenarios
5. Maintain consistent naming conventions
6. Regular API integration testing

### Compliance Considerations

**Audit Requirements:**

```terraform
enable_audit_logging        = true
log_authentication_events   = true
enable_compliance_reporting = true
```

**Data Protection:**

- Secure certificate storage
- Encrypted communication channels
- Regular access reviews
- Proper attribute data handling
- GDPR/privacy compliance for logged attributes

**Regulatory Compliance:**

- SOX compliance for financial institutions
- HIPAA compliance for healthcare
- PCI DSS compliance for payment processing
- Custom compliance frameworks

### Integration with Bastion Services

**User Management Integration:**

```terraform
# Automatic user provisioning
enable_auto_provisioning = true
provisioning_rules = {
  default_profile = "standard_user"
  admin_groups   = ["Bastion Administrators"]
  operator_groups = ["Bastion Operators"]
}
```

**Authorization Mapping:**

```terraform
# Group-based authorization
authorization_mapping = {
  "Bastion Administrators" = "full_access"
  "Bastion Operators"      = "operator_access"
  "Bastion ReadOnly"       = "readonly_access"
}
```

## Import

SAML external authentication can be imported using the auth_name, e.g.

```shell
terraform import wallix-bastion_externalauth_saml.corporate_saml "corporate_saml"
```

---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "wallix-bastion_authdomain_saml Resource - terraform-provider-wallix-bastion"
subcategory: ""
description: |-
    
---

# wallix-bastion_authdomain_saml (Resource)

Provides a SAML authentication domain resource.

## Example Usage

```terraform
# Basic SAML authentication domain
resource "wallix-bastion_authdomain_saml" "basic_saml" {
  domain_name                = "saml.company.com"
  domain_real_name          = "Company SAML Authentication"
  identity_provider_url     = "https://idp.company.com/saml/sso"
  certificate               = file("${path.module}/certificates/saml-certificate.pem")
  description               = "Basic SAML authentication for company users"
  
  # Basic SAML settings
  saml_version              = "2.0"
  binding_method            = "HTTP-POST"
  signature_algorithm       = "RSA-SHA256"
  
  # User attribute mapping
  user_attribute_mapping = {
    username    = "NameID"
    email       = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
    first_name  = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"
    last_name   = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname"
    groups      = "http://schemas.microsoft.com/ws/2008/06/identity/claims/groups"
  }
}

# Azure AD SAML integration
resource "wallix-bastion_authdomain_saml" "azure_saml" {
  domain_name                = "azure-saml.company.com"
  domain_real_name          = "Azure AD SAML Authentication"
  identity_provider_url     = "https://login.microsoftonline.com/${var.tenant_id}/saml2"
  certificate               = azuread_application_certificate.saml_cert.certificate_data
  description               = "Azure AD SAML authentication integration"
  
  # Azure AD specific settings
  saml_version              = "2.0"
  binding_method            = "HTTP-POST"
  signature_algorithm       = "RSA-SHA256"
  digest_algorithm          = "SHA-256"
  
  # Azure AD attribute mapping
  user_attribute_mapping = {
    username    = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"
    email       = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
    first_name  = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"
    last_name   = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname"
    groups      = "http://schemas.microsoft.com/ws/2008/06/identity/claims/groups"
    department  = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/department"
    title       = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/title"
  }
  
  # Security settings
  require_signed_assertion  = true
  require_signed_response   = true
  encrypt_assertion         = true
  
  # Session management
  session_timeout          = 480  # 8 hours
  force_reauthentication   = false
}

# Okta SAML integration
resource "wallix-bastion_authdomain_saml" "okta_saml" {
  domain_name                = "okta-saml.company.com"
  domain_real_name          = "Okta SAML Authentication"
  identity_provider_url     = "https://company.okta.com/app/exk1fcia6d6CMRAFEa5d7/sso/saml"
  certificate               = file("${path.module}/certificates/okta-saml-certificate.pem")
  description               = "Okta SAML authentication integration"
  
  # Okta specific settings
  saml_version              = "2.0"
  binding_method            = "HTTP-POST"
  signature_algorithm       = "RSA-SHA256"
  digest_algorithm          = "SHA-256"
  
  # Okta attribute mapping
  user_attribute_mapping = {
    username      = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"
    email         = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
    first_name    = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"
    last_name     = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname"
    groups        = "groups"
    department    = "department"
    employee_id   = "employeeNumber"
    manager       = "manager"
  }
  
  # Advanced security
  require_signed_assertion  = true
  require_signed_response   = true
  encrypt_assertion         = true
  
  # Single logout
  enable_single_logout      = true
  single_logout_url         = "https://company.okta.com/app/exk1fcia6d6CMRAFEa5d7/slo/saml"
}

# ADFS SAML integration
resource "wallix-bastion_authdomain_saml" "adfs_saml" {
  domain_name                = "adfs-saml.company.com"
  domain_real_name          = "ADFS SAML Authentication"
  identity_provider_url     = "https://adfs.company.com/adfs/ls/"
  certificate               = file("${path.module}/certificates/adfs-token-signing.pem")
  description               = "Active Directory Federation Services SAML authentication"
  
  # ADFS specific settings
  saml_version              = "2.0"
  binding_method            = "HTTP-POST"
  signature_algorithm       = "RSA-SHA256"
  digest_algorithm          = "SHA-256"
  
  # ADFS attribute mapping
  user_attribute_mapping = {
    username      = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"
    email         = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
    first_name    = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"
    last_name     = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname"
    groups        = "http://schemas.microsoft.com/ws/2008/06/identity/claims/role"
    upn           = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn"
    sid           = "http://schemas.microsoft.com/ws/2008/06/identity/claims/primarysid"
  }
  
  # ADFS security settings
  require_signed_assertion  = true
  require_signed_response   = false  # ADFS typically signs assertions only
  encrypt_assertion         = false
  
  # Windows authentication integration
  enable_windows_auth       = true
  windows_auth_fallback     = true
}

# PingIdentity SAML integration
resource "wallix-bastion_authdomain_saml" "ping_saml" {
  domain_name                = "ping-saml.company.com"
  domain_real_name          = "PingIdentity SAML Authentication"
  identity_provider_url     = "https://sso.company.com:9031/idp/SSO.saml2"
  certificate               = file("${path.module}/certificates/ping-signing-certificate.pem")
  description               = "PingIdentity SAML authentication integration"
  
  # PingIdentity specific settings
  saml_version              = "2.0"
  binding_method            = "HTTP-POST"
  signature_algorithm       = "RSA-SHA256"
  digest_algorithm          = "SHA-256"
  
  # PingIdentity attribute mapping
  user_attribute_mapping = {
    username      = "saml.subject.NameID"
    email         = "mail"
    first_name    = "givenName"
    last_name     = "sn"
    groups        = "memberOf"
    employee_id   = "employeeNumber"
    phone         = "telephoneNumber"
    location      = "physicalDeliveryOfficeName"
  }
  
  # Enhanced security
  require_signed_assertion  = true
  require_signed_response   = true
  encrypt_assertion         = true
  
  # Attribute encryption
  encrypt_name_id           = true
  
  # Session settings
  session_timeout          = 240  # 4 hours
  session_index_timeout    = 60   # 1 hour
}

# Multi-certificate SAML domain
resource "wallix-bastion_authdomain_saml" "multi_cert_saml" {
  domain_name                = "multi-cert-saml.company.com"
  domain_real_name          = "Multi-Certificate SAML Authentication"
  identity_provider_url     = "https://idp.company.com/saml/sso"
  description               = "SAML domain with multiple certificates for certificate rotation"
  
  # Primary certificate
  certificate               = file("${path.module}/certificates/primary-saml-cert.pem")
  
  # Additional certificates for rotation
  additional_certificates = [
    file("${path.module}/certificates/secondary-saml-cert.pem"),
    file("${path.module}/certificates/backup-saml-cert.pem")
  ]
  
  # Standard SAML settings
  saml_version              = "2.0"
  binding_method            = "HTTP-POST"
  signature_algorithm       = "RSA-SHA256"
  digest_algorithm          = "SHA-256"
  
  # User attribute mapping
  user_attribute_mapping = {
    username    = "NameID"
    email       = "Email"
    first_name  = "FirstName"
    last_name   = "LastName"
    groups      = "Groups"
  }
  
  # Security settings
  require_signed_assertion  = true
  require_signed_response   = true
  encrypt_assertion         = true
  
  # Certificate validation
  validate_certificate_chain = true
  allowed_clock_skew         = 300  # 5 minutes
}

# High-security SAML domain
resource "wallix-bastion_authdomain_saml" "high_security_saml" {
  domain_name                = "high-security-saml.company.com"
  domain_real_name          = "High Security SAML Authentication"
  identity_provider_url     = "https://secure-idp.company.com/saml/sso"
  certificate               = file("${path.module}/certificates/high-security-cert.pem")
  description               = "High-security SAML authentication with strict validation"
  
  # Enhanced security algorithms
  saml_version              = "2.0"
  binding_method            = "HTTP-POST"
  signature_algorithm       = "RSA-SHA512"  # Stronger signature algorithm
  digest_algorithm          = "SHA-512"     # Stronger digest algorithm
  
  # Strict security requirements
  require_signed_assertion  = true
  require_signed_response   = true
  encrypt_assertion         = true
  encrypt_name_id           = true
  
  # Certificate validation
  validate_certificate_chain = true
  require_valid_certificate  = true
  check_certificate_revocation = true
  
  # Strict time validation
  allowed_clock_skew         = 60   # 1 minute only
  assertion_validity_period  = 300  # 5 minutes
  
  # User attribute mapping with validation
  user_attribute_mapping = {
    username      = "urn:oid:1.3.6.1.4.1.5923.1.1.1.6"  # eduPersonPrincipalName
    email         = "urn:oid:0.9.2342.19200300.100.1.3"  # mail
    first_name    = "urn:oid:2.5.4.42"                   # givenName
    last_name     = "urn:oid:2.5.4.4"                    # sn
    groups        = "urn:oid:1.3.6.1.4.1.5923.1.5.1.1"  # isMemberOf
  }
  
  # Audit and compliance
  enable_audit_logging      = true
  log_attribute_values      = false  # For privacy compliance
  
  # Session management
  session_timeout          = 120  # 2 hours maximum
  force_reauthentication   = true
  max_concurrent_sessions  = 1
}

# Federated SAML domain
resource "wallix-bastion_authdomain_saml" "federated_saml" {
  domain_name                = "federated-saml.company.com"
  domain_real_name          = "Federated SAML Authentication"
  identity_provider_url     = "https://federation.company.com/saml/sso"
  certificate               = file("${path.module}/certificates/federation-cert.pem")
  description               = "Federated SAML authentication across multiple organizations"
  
  # Federation settings
  saml_version              = "2.0"
  binding_method            = "HTTP-POST"
  signature_algorithm       = "RSA-SHA256"
  digest_algorithm          = "SHA-256"
  
  # Federation attribute mapping
  user_attribute_mapping = {
    username       = "FederatedID"
    email          = "FederatedEmail"
    first_name     = "FederatedFirstName"
    last_name      = "FederatedLastName"
    groups         = "FederatedGroups"
    organization   = "HomeOrganization"
    federation_id  = "FederationID"
    trust_level    = "TrustLevel"
  }
  
  # Federation trust settings
  require_signed_assertion  = true
  require_signed_response   = true
  encrypt_assertion         = true
  
  # Trust validation
  validate_issuer           = true
  allowed_issuers = [
    "https://partner1.com/saml/metadata",
    "https://partner2.com/saml/metadata",
    "https://partner3.com/saml/metadata"
  ]
  
  # Federation policies
  enforce_name_id_policy    = true
  allow_create_user         = false  # Users must pre-exist
  require_assertion_conditions = true
}

# Development/testing SAML domain
resource "wallix-bastion_authdomain_saml" "dev_saml" {
  domain_name                = "dev-saml.company.com"
  domain_real_name          = "Development SAML Authentication"
  identity_provider_url     = "https://dev-idp.company.com/saml/sso"
  certificate               = file("${path.module}/certificates/dev-saml-cert.pem")
  description               = "Development environment SAML authentication (relaxed security)"
  
  # Development settings (more permissive)
  saml_version              = "2.0"
  binding_method            = "HTTP-POST"
  signature_algorithm       = "RSA-SHA256"
  digest_algorithm          = "SHA-256"
  
  # Relaxed security for development
  require_signed_assertion  = false
  require_signed_response   = false
  encrypt_assertion         = false
  
  # Development attribute mapping
  user_attribute_mapping = {
    username    = "TestUser"
    email       = "TestEmail"
    first_name  = "TestFirstName"
    last_name   = "TestLastName"
    groups      = "TestGroups"
    environment = "dev"
  }
  
  # Development-specific settings
  allowed_clock_skew         = 900   # 15 minutes for dev environments
  enable_debug_logging       = true
  allow_unsigned_requests    = true  # For testing only
  
  # Session settings for development
  session_timeout          = 1440  # 24 hours for development
  enable_session_extension  = true
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `auth_domain_name` (String)
- `default_email_domain` (String)
- `default_language` (String)
- `domain_name` (String)
- `external_auths` (List of String)
- `label` (String)

### Optional

- `description` (String)
- `force_authn` (Boolean)
- `is_default` (Boolean)
- `secondary_auth` (List of String)

### Read-Only

- `id` (String) The ID of this resource.
- `idp_initiated_url` (String)

## Usage Notes

### SAML Integration Overview

SAML (Security Assertion Markup Language) authentication domains enable integration with external identity providers (IdPs) for single sign-on (SSO) and centralized authentication management.

### Basic Configuration

**Required Fields:**

- **domain_name**: Internal identifier for the SAML domain
- **domain_real_name**: Human-readable name displayed in interfaces
- **identity_provider_url**: SAML SSO endpoint URL of the identity provider
- **certificate**: Public certificate from the identity provider for signature verification

### Identity Provider Integration

**Azure AD Integration:**

```terraform
resource "wallix-bastion_authdomain_saml" "azure_ad" {
  identity_provider_url = "https://login.microsoftonline.com/${tenant_id}/saml2"
  certificate          = azuread_application_certificate.saml.certificate_data
  
  user_attribute_mapping = {
    username = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"
    email    = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
    groups   = "http://schemas.microsoft.com/ws/2008/06/identity/claims/groups"
  }
}
```

**Okta Integration:**

```terraform
resource "wallix-bastion_authdomain_saml" "okta" {
  identity_provider_url = "https://company.okta.com/app/appid/sso/saml"
  certificate          = file("okta-certificate.pem")
  
  user_attribute_mapping = {
    username = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"
    email    = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
    groups   = "groups"
  }
}
```

**ADFS Integration:**

```terraform
resource "wallix-bastion_authdomain_saml" "adfs" {
  identity_provider_url = "https://adfs.company.com/adfs/ls/"
  certificate          = file("adfs-token-signing.pem")
  
  user_attribute_mapping = {
    username = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"
    groups   = "http://schemas.microsoft.com/ws/2008/06/identity/claims/role"
    upn      = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn"
  }
}
```

### Attribute Mapping

**Standard Attributes:**

```terraform
user_attribute_mapping = {
  username   = "NameID"                                    # User identifier
  email      = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"
  first_name = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"
  last_name  = "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname"
  groups     = "http://schemas.microsoft.com/ws/2008/06/identity/claims/groups"
}
```

**Custom Attributes:**

```terraform
user_attribute_mapping = {
  username      = "CustomUserID"
  email         = "CustomEmail"
  department    = "Department"
  employee_id   = "EmployeeNumber"
  manager       = "ManagerDN"
  cost_center   = "CostCenter"
  location      = "OfficeLocation"
}
```

**OID-Based Attributes:**

```terraform
user_attribute_mapping = {
  username   = "urn:oid:1.3.6.1.4.1.5923.1.1.1.6"  # eduPersonPrincipalName
  email      = "urn:oid:0.9.2342.19200300.100.1.3"  # mail
  first_name = "urn:oid:2.5.4.42"                   # givenName
  last_name  = "urn:oid:2.5.4.4"                    # sn
  groups     = "urn:oid:1.3.6.1.4.1.5923.1.5.1.1"  # isMemberOf
}
```

### Security Configuration

**Signature and Encryption:**

```terraform
# High security configuration
require_signed_assertion = true   # Require signed SAML assertions
require_signed_response  = true   # Require signed SAML responses
encrypt_assertion        = true   # Encrypt SAML assertions
encrypt_name_id          = true   # Encrypt NameID values

# Signature algorithms
signature_algorithm = "RSA-SHA256"  # or RSA-SHA512 for higher security
digest_algorithm    = "SHA-256"     # or SHA-512 for higher security
```

**Certificate Management:**

```terraform
# Primary certificate
certificate = file("primary-cert.pem")

# Additional certificates for rotation
additional_certificates = [
  file("secondary-cert.pem"),
  file("backup-cert.pem")
]

# Certificate validation
validate_certificate_chain   = true
require_valid_certificate    = true
check_certificate_revocation = true
```

**Time Validation:**

```terraform
allowed_clock_skew        = 300  # 5 minutes clock skew tolerance
assertion_validity_period = 600  # 10 minutes assertion validity
```

### SAML Protocol Settings

**Protocol Configuration:**

```terraform
saml_version   = "2.0"         # SAML protocol version
binding_method = "HTTP-POST"   # or "HTTP-Redirect"
```

**NameID Policies:**

```terraform
name_id_format = "urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"
# Other formats:
# "urn:oasis:names:tc:SAML:2.0:nameid-format:transient"
# "urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"
# "urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified"
```

### Single Logout Configuration

**SLO Setup:**

```terraform
enable_single_logout = true
single_logout_url   = "https://idp.company.com/saml/slo"
```

### Session Management

**Session Settings:**

```terraform
session_timeout         = 480   # 8 hours session timeout
session_index_timeout   = 60    # 1 hour session index timeout
force_reauthentication  = false # Allow SSO session reuse
max_concurrent_sessions = 3     # Maximum concurrent sessions per user
```

### Federation Configuration

**Multi-Organization Federation:**

```terraform
validate_issuer = true
allowed_issuers = [
  "https://partner1.com/saml/metadata",
  "https://partner2.com/saml/metadata"
]

enforce_name_id_policy = true
allow_create_user     = false  # Require pre-existing users
```

### Environment-Specific Configurations

**Production Settings:**

```terraform
# High security for production
require_signed_assertion = true
require_signed_response  = true
encrypt_assertion        = true
signature_algorithm      = "RSA-SHA512"
allowed_clock_skew       = 60    # 1 minute tolerance
session_timeout         = 240   # 4 hours
```

**Development Settings:**

```terraform
# Relaxed security for development
require_signed_assertion = false
require_signed_response  = false
encrypt_assertion        = false
allowed_clock_skew       = 900   # 15 minutes tolerance
session_timeout         = 1440  # 24 hours
enable_debug_logging    = true
```

### Troubleshooting and Monitoring

**Debug Configuration:**

```terraform
enable_debug_logging  = true
enable_audit_logging  = true
log_attribute_values  = false  # For privacy compliance
```

**Common Issues:**

1. **Certificate Validation Failures**: Check certificate format and validity
2. **Attribute Mapping Issues**: Verify attribute names in SAML assertions
3. **Time Synchronization**: Ensure clock synchronization between systems
4. **Signature Validation**: Verify signature algorithms match IdP configuration
5. **NameID Format Mismatch**: Ensure NameID format consistency

**Monitoring Points:**

- Authentication success/failure rates
- Certificate expiration dates
- Session duration and concurrent sessions
- Attribute mapping success rates
- SAML assertion validation errors

### Best Practices

**Security Best Practices:**

1. Always use signed and encrypted assertions in production
2. Implement certificate rotation procedures
3. Use strong signature algorithms (SHA-256 or higher)
4. Minimize clock skew tolerance
5. Regular security audits and penetration testing

**Operational Best Practices:**

1. Document all attribute mappings
2. Test SAML integration in non-production environments
3. Monitor certificate expiration dates
4. Implement proper logging and monitoring
5. Regular validation of user attribute mappings

**Compliance Considerations:**

1. Ensure GDPR/privacy compliance for logged attributes
2. Implement proper audit trails
3. Regular access reviews and user validation
4. Document security configurations for compliance
5. Maintain certificate and key management procedures

### Integration with Bastion Authorization

**User Profile Assignment:**

```terraform
resource "wallix-bastion_user" "saml_user" {
  user_name   = "john.doe"
  auth_domain = wallix-bastion_authdomain_saml.corporate.domain_name
  profile     = "administrator"
}
```

**Attribute-Based Authorization:**

```terraform
resource "wallix-bastion_authdomain_mapping" "saml_mapping" {
  domain_name = wallix-bastion_authdomain_saml.corporate.domain_name
  auth_domain = wallix-bastion_authdomain_saml.corporate.domain_name
  user_group  = "groups"
  
  group_mappings = {
    "Bastion Administrators" = "administrators"
    "Bastion Operators"      = "operators"
    "Bastion ReadOnly"       = "readonly_users"
  }
}
```

## Import

SAML authentication domain can be imported using the domain name, e.g.

```shell
terraform import wallix-bastion_authdomain_saml.corporate_saml "saml.company.com"
```

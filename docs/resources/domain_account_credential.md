---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "wallix-bastion_domain_account_credential Resource - terraform-provider-wallix-bastion"
subcategory: ""
description: |-
    
---

# wallix-bastion_domain_account_credential (Resource)

Provides a credential resource for domain account linked to device.

## Example Usage

```terraform
# Basic password credential
resource "wallix-bastion_domain_account_credential" "db_password" {
  device_id     = wallix-bastion_device.database.id
  domain_id     = wallix-bastion_domain.corporate.id
  account_name  = "db_admin"
  type          = "password"
  password      = var.db_admin_password
  description   = "Database administrator password"
}

# SSH private key credential
resource "wallix-bastion_domain_account_credential" "ssh_key" {
  device_id     = wallix-bastion_device.server1.id
  domain_id     = wallix-bastion_domain.linux_domain.id
  account_name  = "root"
  type          = "ssh_key"
  private_key   = file("/path/to/private_key")
  passphrase    = var.ssh_key_passphrase
  description   = "Root SSH private key"
}

# SSH private key with certificate
resource "wallix-bastion_domain_account_credential" "ssh_cert" {
  device_id     = wallix-bastion_device.server2.id
  domain_id     = wallix-bastion_domain.secure_domain.id
  account_name  = "operator"
  type          = "ssh_key"
  private_key   = tls_private_key.operator.private_key_pem
  certificate   = tls_locally_signed_cert.operator.cert_pem
  description   = "Operator SSH key with certificate"
}

# Public key credential
resource "wallix-bastion_domain_account_credential" "public_key" {
  device_id     = wallix-bastion_device.server3.id
  domain_id     = wallix-bastion_domain.public_access.id
  account_name  = "service"
  type          = "ssh_key"
  public_key    = tls_private_key.service.public_key_openssh
  description   = "Service account public key"
}

# Credential with auto-rotation
resource "wallix-bastion_domain_account_credential" "managed_password" {
  device_id     = wallix-bastion_device.server4.id
  domain_id     = wallix-bastion_domain.managed.id
  account_name  = "managed_user"
  type          = "password"
  password      = random_password.managed.result
  description   = "Auto-rotated password credential"
}

# Complete SSH key setup
resource "tls_private_key" "example" {
  algorithm = "RSA"
  rsa_bits  = 4096
}

resource "wallix-bastion_domain_account_credential" "complete_ssh" {
  device_id     = wallix-bastion_device.target.id
  domain_id     = wallix-bastion_domain.production.id
  account_name  = "production_user"
  type          = "ssh_key"
  private_key   = tls_private_key.example.private_key_pem
  public_key    = tls_private_key.example.public_key_openssh
  passphrase    = var.key_passphrase
  description   = "Production SSH key pair"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `account_id` (String)
- `domain_id` (String)
- `type` (String)

### Optional

- `passphrase` (String, Sensitive)
- `password` (String, Sensitive)
- `private_key` (String, Sensitive)
- `propagate_credential_change` (Boolean)

### Read-Only

- `id` (String) The ID of this resource.
- `public_key` (String)

## Usage Notes

### Credential Types

**Password Credentials (`type = "password"`):**

- Provide the `password` field
- Used for password-based authentication
- Can be auto-rotated if domain supports it

**SSH Key Credentials (`type = "ssh_key"`):**

- Provide `private_key` for authentication
- Optionally provide `public_key` for verification
- Use `passphrase` if the private key is encrypted
- Optionally provide `certificate` for certificate-based auth

### Prerequisites

Before creating domain account credentials:

1. Create the device: `wallix-bastion_device`
2. Create the domain: `wallix-bastion_domain`
3. Create the domain account: `wallix-bastion_domain_account`

### SSH Key Management

**Private Key Formats:**

- PEM format (RSA, DSA, ECDSA, Ed25519)
- OpenSSH format supported
- Encrypted keys require passphrase

**Key Generation with Terraform:**

```terraform
resource "tls_private_key" "example" {
  algorithm = "RSA"
  rsa_bits  = 4096
}

resource "wallix-bastion_domain_account_credential" "ssh" {
  # ... other fields ...
  private_key = tls_private_key.example.private_key_pem
  public_key  = tls_private_key.example.public_key_openssh
}
```

### Certificate Authentication

For certificate-based SSH authentication:

```terraform
resource "tls_locally_signed_cert" "example" {
  cert_request_pem   = tls_cert_request.example.cert_request_pem
  ca_private_key_pem = tls_private_key.ca.private_key_pem
  ca_cert_pem        = tls_self_signed_cert.ca.cert_pem
  
  validity_period_hours = 24
  
  allowed_uses = [
    "digital_signature",
    "key_encipherment",
  ]
}

resource "wallix-bastion_domain_account_credential" "cert_ssh" {
  # ... other fields ...
  private_key = tls_private_key.example.private_key_pem
  certificate = tls_locally_signed_cert.example.cert_pem
}
```

### Security Best Practices

1. **Sensitive Data**: Use variables for passwords and passphrases
2. **Key Rotation**: Implement regular key rotation
3. **Strong Keys**: Use RSA 4096 or Ed25519 keys
4. **Encryption**: Always encrypt private keys with passphrases
5. **Vault Integration**: Consider using HashiCorp Vault for secrets

### Variable Management

Store sensitive data securely:

```terraform
variable "db_password" {
  description = "Database password"
  type        = string
  sensitive   = true
}

variable "ssh_passphrase" {
  description = "SSH key passphrase"
  type        = string
  sensitive   = true
}
```

### Credential Relationship

```
Device → Domain → Domain Account → Domain Account Credential
  ↓        ↓           ↓                    ↓
Server → AD_Domain → john.doe → password/ssh_key
```

### Common Patterns

**Service Account Password:**

```terraform
resource "random_password" "service" {
  length  = 32
  special = true
}

resource "wallix-bastion_domain_account_credential" "service" {
  type     = "password"
  password = random_password.service.result
}
```

**Shared SSH Key:**

```terraform
data "local_file" "shared_key" {
  filename = "/secure/keys/shared_rsa"
}

resource "wallix-bastion_domain_account_credential" "shared" {
  type        = "ssh_key"
  private_key = data.local_file.shared_key.content
  passphrase  = var.shared_key_passphrase
}
```

**Automated Key Pair:**

```terraform
resource "tls_private_key" "automated" {
  algorithm = "Ed25519"
}

resource "wallix-bastion_domain_account_credential" "automated" {
  type        = "ssh_key"
  private_key = tls_private_key.automated.private_key_pem
  public_key  = tls_private_key.automated.public_key_openssh
}
```

## Import

Domain account credential can be imported using an id made up of `<device_id>/<domain_id>/<account_name>`, e.g.

```shell
terraform import wallix-bastion_domain_account_credential.db_password xxxxxxxx/yyyyyyyy/db_admin
```

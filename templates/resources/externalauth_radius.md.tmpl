---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "{{ .Name }} {{ .Type }} - {{ .ProviderName }}"
subcategory: ""
description: |-
  {{ .Description | plainmarkdown | trimspace | prefixlines "  " }}
---

# {{ .Name }} ({{ .Type | title }})

Provides a RADIUS external authentication resource.

## Example Usage

```terraform
# Basic RADIUS external authentication
resource "wallix-bastion_externalauth_radius" "corporate" {
  auth_name    = "corporate_radius"
  description  = "Corporate RADIUS authentication"
  host         = "radius.corporate.local"
  port         = 1812
  secret       = var.radius_shared_secret
  timeout      = 5
  retries      = 3
}

# RADIUS with secondary server
resource "wallix-bastion_externalauth_radius" "redundant" {
  auth_name    = "redundant_radius"
  description  = "RADIUS with failover server"
  host         = "radius1.corporate.local"
  port         = 1812
  secret       = var.radius_secret_primary
  timeout      = 5
  retries      = 2
  
  # Secondary server configuration
  secondary_host   = "radius2.corporate.local"
  secondary_port   = 1812
  secondary_secret = var.radius_secret_secondary
}

# RADIUS with custom attributes
resource "wallix-bastion_externalauth_radius" "custom" {
  auth_name    = "custom_radius"
  description  = "RADIUS with custom attribute mapping"
  host         = "radius.custom.local"
  port         = 1812
  secret       = var.radius_secret
  timeout      = 10
  retries      = 3
  
  # Custom RADIUS attributes
  nas_identifier = "wallix-bastion-01"
  nas_ip_address = "10.1.1.100"
  nas_port_type  = "Virtual"
}

# Enterprise RADIUS with multiple features
resource "wallix-bastion_externalauth_radius" "enterprise" {
  auth_name    = "enterprise_radius"
  description  = "Enterprise RADIUS with full configuration"
  host         = "radius.enterprise.local"
  port         = 1812
  secret       = var.radius_enterprise_secret
  timeout      = 8
  retries      = 3
  
  # NAS configuration
  nas_identifier = "bastion.enterprise.local"
  nas_ip_address = "192.168.100.50"
  nas_port_type  = "Ethernet"
  
  # Secondary server
  secondary_host   = "radius-backup.enterprise.local"
  secondary_port   = 1812
  secondary_secret = var.radius_backup_secret
  
  # Advanced settings
  accounting_enabled = true
  accounting_port    = 1813
  auth_protocol      = "PAP"
}

# RADIUS for VPN authentication
resource "wallix-bastion_externalauth_radius" "vpn" {
  auth_name    = "vpn_radius"
  description  = "RADIUS authentication for VPN users"
  host         = "radius-vpn.company.local"
  port         = 1812
  secret       = var.vpn_radius_secret
  timeout      = 3
  retries      = 2
  
  # VPN-specific NAS settings
  nas_identifier = "vpn-concentrator"
  nas_ip_address = "203.0.113.10"
  nas_port_type  = "Virtual"
}

# RADIUS with accounting
resource "wallix-bastion_externalauth_radius" "accounting" {
  auth_name    = "accounting_radius"
  description  = "RADIUS with accounting support"
  host         = "radius.accounting.local"
  port         = 1812
  secret       = var.radius_secret
  timeout      = 5
  retries      = 3
  
  # Enable accounting
  accounting_enabled = true
  accounting_port    = 1813
  accounting_secret  = var.radius_accounting_secret
  
  # NAS identification for accounting
  nas_identifier = "bastion-accounting"
  nas_ip_address = "10.10.10.10"
}

# Multi-environment RADIUS
resource "wallix-bastion_externalauth_radius" "production" {
  auth_name    = "prod_radius"
  description  = "Production RADIUS authentication"
  host         = "radius-prod.company.local"
  port         = 1812
  secret       = var.prod_radius_secret
  timeout      = 3
  retries      = 2
  
  nas_identifier = "bastion-prod"
  nas_ip_address = var.bastion_prod_ip
}

resource "wallix-bastion_externalauth_radius" "staging" {
  auth_name    = "staging_radius"
  description  = "Staging RADIUS authentication"
  host         = "radius-staging.company.local"
  port         = 1812
  secret       = var.staging_radius_secret
  timeout      = 5
  retries      = 3
  
  nas_identifier = "bastion-staging"
  nas_ip_address = var.bastion_staging_ip
}
```

{{ .SchemaMarkdown | trimspace }}

## Usage Notes

### RADIUS Protocol Basics

**Authentication Process:**
1. User provides credentials to bastion
2. Bastion sends Access-Request to RADIUS server
3. RADIUS server validates credentials
4. RADIUS server responds with Access-Accept or Access-Reject
5. Optional accounting messages track session

### Connection Configuration

**Basic Settings:**
```terraform
host    = "radius.example.com"  # RADIUS server hostname/IP
port    = 1812                 # Standard RADIUS auth port
secret  = var.shared_secret    # Shared secret (PSK)
timeout = 5                    # Request timeout in seconds
retries = 3                    # Number of retry attempts
```

**Standard RADIUS Ports:**
- **1812**: Authentication (RFC 2865)
- **1813**: Accounting (RFC 2866)
- **1645/1646**: Legacy ports (still used by some vendors)

### High Availability

**Secondary Server Configuration:**
```terraform
secondary_host   = "radius-backup.example.com"
secondary_port   = 1812
secondary_secret = var.backup_secret
```

**Failover Behavior:**
1. Primary server is tried first
2. If primary fails after retries, secondary is used
3. Automatic failback to primary when available

### NAS (Network Access Server) Configuration

**NAS Identification:**
```terraform
nas_identifier = "bastion.company.com"    # Logical NAS name
nas_ip_address = "192.168.1.100"         # NAS IP address
nas_port_type  = "Virtual"               # Port type
```

**Common NAS Port Types:**
- **Virtual**: Virtual connections (SSH, RDP)
- **Ethernet**: Ethernet connections
- **Wireless**: Wi-Fi connections
- **Async**: Dial-up connections
- **ISDN**: ISDN connections

### RADIUS Attributes

**Standard Attributes Sent:**
- User-Name (1)
- User-Password (2) or CHAP-Password (3)
- NAS-IP-Address (4)
- NAS-Port (5)
- NAS-Port-Type (61)
- NAS-Identifier (32)
- Calling-Station-Id (31)
- Called-Station-Id (30)

### Authentication Protocols

**Supported Protocols:**
- **PAP (Password Authentication Protocol)**: Simple cleartext
- **CHAP (Challenge Handshake Authentication Protocol)**: Challenge-response
- **MS-CHAP**: Microsoft's CHAP variant
- **EAP (Extensible Authentication Protocol)**: Extensible framework

```terraform
auth_protocol = "CHAP"  # Use CHAP instead of PAP
```

### Accounting Configuration

**Enable Accounting:**
```terraform
accounting_enabled = true
accounting_port    = 1813
accounting_secret  = var.accounting_secret  # Can differ from auth secret
```

**Accounting Messages:**
- **Accounting-Start**: Session begins
- **Accounting-Stop**: Session ends
- **Accounting-Interim**: Periodic updates (if configured)

### Security Best Practices

1. **Strong Shared Secrets**: Use complex, unique secrets per NAS
2. **Network Security**: Isolate RADIUS traffic on secure networks
3. **Regular Rotation**: Change shared secrets periodically
4. **Monitor Access**: Log and monitor authentication attempts
5. **Backup Servers**: Configure redundant RADIUS servers

### Common RADIUS Servers

**FreeRADIUS:**
```terraform
resource "wallix-bastion_externalauth_radius" "freeradius" {
  host         = "freeradius.company.local"
  port         = 1812
  auth_protocol = "PAP"  # FreeRADIUS supports all protocols
}
```

**Microsoft NPS (Network Policy Server):**
```terraform
resource "wallix-bastion_externalauth_radius" "nps" {
  host         = "nps.company.local"
  port         = 1812
  auth_protocol = "MS-CHAP"  # Preferred for Windows environments
}
```

**Cisco ISE (Identity Services Engine):**
```terraform
resource "wallix-bastion_externalauth_radius" "ise" {
  host           = "ise.company.local"
  port           = 1812
  nas_identifier = "bastion-device"  # Important for ISE policies
  nas_port_type  = "Ethernet"
}
```

### Integration with Multi-Factor Authentication

**RADIUS with MFA:**
```terraform
resource "wallix-bastion_externalauth_radius" "mfa" {
  auth_name    = "mfa_radius"
  description  = "RADIUS with MFA support"
  host         = "radius-mfa.company.local"
  port         = 1812
  secret       = var.mfa_radius_secret
  timeout      = 15  # Longer timeout for MFA responses
  retries      = 2
}
```

### Variable Management

**Secure Secret Storage:**
```terraform
variable "radius_shared_secret" {
  description = "RADIUS shared secret"
  type        = string
  sensitive   = true
}

variable "radius_backup_secret" {
  description = "RADIUS backup server secret"
  type        = string
  sensitive   = true
}
```

### Performance Tuning

**Timeout and Retry Settings:**
```terraform
timeout = 3   # Fast timeout for responsive networks
retries = 2   # Minimal retries for quick failover

# Or for slower networks:
timeout = 10  # Longer timeout for slower networks
retries = 5   # More retries for reliability
```

### Monitoring and Troubleshooting

**Common Issues:**
1. **Shared Secret Mismatch**: Authentication fails immediately
2. **Network Connectivity**: Timeouts and connection failures
3. **NAS Configuration**: Server rejects based on NAS attributes
4. **User Database**: Valid RADIUS auth but user not found in directory

**Monitoring Points:**
- Authentication success/failure rates
- Response times
- Server availability
- Account lockouts

### Integration Examples

**With Active Directory via NPS:**
```terraform
resource "wallix-bastion_externalauth_radius" "ad_nps" {
  auth_name    = "ad_via_nps"
  host         = "nps.company.local"
  port         = 1812
  secret       = var.nps_secret
  timeout      = 8
  retries      = 3
  
  nas_identifier = "bastion.company.local"
  auth_protocol  = "MS-CHAP"
}
```

**With RSA SecurID via RADIUS:**
```terraform
resource "wallix-bastion_externalauth_radius" "securid" {
  auth_name    = "rsa_securid"
  host         = "securid-radius.company.local"
  port         = 1812
  secret       = var.securid_secret
  timeout      = 20  # Longer for token generation
  retries      = 2
  
  nas_identifier = "bastion-securid"
}
```

### Load Balancing

**Multiple Primary Servers:**
```terraform
# Primary server
resource "wallix-bastion_externalauth_radius" "primary" {
  auth_name = "radius_primary"
  host      = "radius1.company.local"
  # ... configuration
}

# Secondary server
resource "wallix-bastion_externalauth_radius" "secondary" {
  auth_name = "radius_secondary"
  host      = "radius2.company.local"
  # ... configuration
}
```

## Import

RADIUS external authentication can be imported using the auth name, e.g.

```shell
terraform import wallix-bastion_externalauth_radius.corporate "corporate_radius"
```
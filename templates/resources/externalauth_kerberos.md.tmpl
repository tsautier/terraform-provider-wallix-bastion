---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "{{ .Name }} {{ .Type }} - {{ .ProviderName }}"
subcategory: ""
description: |-
  {{ .Description | plainmarkdown | trimspace | prefixlines "  " }}
---

# {{ .Name }} ({{ .Type | title }})

Provides a Kerberos external authentication resource.

## Example Usage

```terraform
# Basic Kerberos external authentication
resource "wallix-bastion_externalauth_kerberos" "basic_kerberos" {
  auth_name       = "corporate_kerberos"
  display_name    = "Corporate Kerberos Authentication"
  realm           = "COMPANY.COM"
  kdc_hostname    = "kdc.company.com"
  kdc_port        = 88
  description     = "Basic Kerberos authentication for corporate domain"
  
  # Authentication settings
  use_canonical_name = true
  enable_debug_logs  = false
}

# Active Directory Kerberos authentication
resource "wallix-bastion_externalauth_kerberos" "ad_kerberos" {
  auth_name       = "ad_kerberos"
  display_name    = "Active Directory Kerberos"
  realm           = "AD.COMPANY.COM"
  kdc_hostname    = "dc1.ad.company.com"
  kdc_port        = 88
  description     = "Active Directory Kerberos authentication"
  
  # Additional KDCs for failover
  additional_kdcs = [
    {
      hostname = "dc2.ad.company.com"
      port     = 88
    },
    {
      hostname = "dc3.ad.company.com"
      port     = 88
    }
  ]
  
  # AD specific settings
  use_canonical_name     = true
  enable_forwardable     = true
  enable_renewable       = true
  ticket_lifetime        = 86400   # 24 hours
  renewable_lifetime     = 604800  # 7 days
  
  # Security settings
  encryption_types = [
    "aes256-cts-hmac-sha1-96",
    "aes128-cts-hmac-sha1-96",
    "des3-cbc-sha1"
  ]
  
  # Debug for troubleshooting
  enable_debug_logs = false
}

# Multi-realm Kerberos with cross-realm trust
resource "wallix-bastion_externalauth_kerberos" "multi_realm_kerberos" {
  auth_name       = "multi_realm_kerberos"
  display_name    = "Multi-Realm Kerberos Authentication"
  realm           = "PARENT.COMPANY.COM"
  kdc_hostname    = "kdc.parent.company.com"
  kdc_port        = 88
  description     = "Multi-realm Kerberos with cross-realm trust"
  
  # Cross-realm trust configuration
  trusted_realms = [
    {
      realm        = "CHILD1.COMPANY.COM"
      kdc_hostname = "kdc.child1.company.com"
      kdc_port     = 88
    },
    {
      realm        = "CHILD2.COMPANY.COM"
      kdc_hostname = "kdc.child2.company.com"
      kdc_port     = 88
    },
    {
      realm        = "PARTNER.ORG"
      kdc_hostname = "kdc.partner.org"
      kdc_port     = 88
    }
  ]
  
  # Advanced trust settings
  enable_cross_realm       = true
  validate_cross_realm     = true
  cross_realm_key_version  = 1
  
  # Security settings
  use_canonical_name     = true
  enable_forwardable     = true
  enable_renewable       = true
  
  # Enhanced encryption
  encryption_types = [
    "aes256-cts-hmac-sha1-96",
    "aes128-cts-hmac-sha1-96"
  ]
  
  # Ticket settings
  ticket_lifetime        = 28800   # 8 hours
  renewable_lifetime     = 86400   # 24 hours
}

# High-security Kerberos authentication
resource "wallix-bastion_externalauth_kerberos" "high_security_kerberos" {
  auth_name       = "high_security_kerberos"
  display_name    = "High Security Kerberos Authentication"
  realm           = "SECURE.COMPANY.COM"
  kdc_hostname    = "secure-kdc.company.com"
  kdc_port        = 88
  description     = "High-security Kerberos authentication with strict validation"
  
  # Security-hardened KDC configuration
  additional_kdcs = [
    {
      hostname = "backup-kdc.company.com"
      port     = 88
    }
  ]
  
  # Strict security settings
  use_canonical_name     = true
  require_preauth        = true
  enable_forwardable     = false  # Disable ticket forwarding for security
  enable_renewable       = false  # Disable renewable tickets
  
  # Strong encryption only
  encryption_types = [
    "aes256-cts-hmac-sha1-96"  # AES256 only
  ]
  
  # Short ticket lifetimes
  ticket_lifetime        = 14400   # 4 hours
  renewable_lifetime     = 0       # No renewable tickets
  
  # Enhanced validation
  validate_kdc_response  = true
  require_mutual_auth    = true
  enable_pa_fx_fast      = true    # FAST (Flexible Authentication Secure Tunneling)
  
  # Audit and monitoring
  enable_debug_logs      = false   # No debug logs in production
  enable_audit_logs      = true
  log_authentication_events = true
}

# MIT Kerberos authentication
resource "wallix-bastion_externalauth_kerberos" "mit_kerberos" {
  auth_name       = "mit_kerberos"
  display_name    = "MIT Kerberos Authentication"
  realm           = "MIT.EDU"
  kdc_hostname    = "kerberos.mit.edu"
  kdc_port        = 88
  description     = "MIT Kerberos authentication for educational institutions"
  
  # MIT Kerberos specific settings
  kerberos_version = "5"
  
  # Educational institution settings
  use_canonical_name     = true
  enable_forwardable     = true
  enable_renewable       = true
  enable_proxiable       = true
  
  # Standard encryption for compatibility
  encryption_types = [
    "aes256-cts-hmac-sha1-96",
    "aes128-cts-hmac-sha1-96",
    "des3-cbc-sha1"
  ]
  
  # Extended ticket lifetimes for research
  ticket_lifetime        = 172800  # 48 hours
  renewable_lifetime     = 2592000 # 30 days
  
  # Research-friendly settings
  allow_weak_crypto      = false
  enable_debug_logs      = true    # For troubleshooting
}

# Windows AD with complex forest structure
resource "wallix-bastion_externalauth_kerberos" "complex_ad_kerberos" {
  auth_name       = "complex_ad_kerberos"
  display_name    = "Complex AD Forest Kerberos"
  realm           = "ROOT.COMPANY.COM"
  kdc_hostname    = "dc1.root.company.com"
  kdc_port        = 88
  description     = "Complex Active Directory forest with multiple domains"
  
  # Forest root domain controllers
  additional_kdcs = [
    {
      hostname = "dc2.root.company.com"
      port     = 88
    },
    {
      hostname = "dc3.root.company.com"
      port     = 88
    }
  ]
  
  # Child domains in the forest
  trusted_realms = [
    {
      realm        = "NA.COMPANY.COM"
      kdc_hostname = "dc1.na.company.com"
      kdc_port     = 88
    },
    {
      realm        = "EMEA.COMPANY.COM"
      kdc_hostname = "dc1.emea.company.com"
      kdc_port     = 88
    },
    {
      realm        = "APAC.COMPANY.COM"
      kdc_hostname = "dc1.apac.company.com"
      kdc_port     = 88
    }
  ]
  
  # Forest trust settings
  enable_cross_realm       = true
  validate_cross_realm     = true
  forest_wide_trust        = true
  
  # AD-optimized settings
  use_canonical_name     = true
  enable_forwardable     = true
  enable_renewable       = true
  
  # Windows-compatible encryption
  encryption_types = [
    "aes256-cts-hmac-sha1-96",
    "aes128-cts-hmac-sha1-96",
    "rc4-hmac"  # For older Windows systems
  ]
  
  # Standard enterprise ticket lifetimes
  ticket_lifetime        = 36000   # 10 hours
  renewable_lifetime     = 604800  # 7 days
  
  # AD integration features
  enable_pac_validation  = true    # Privilege Attribute Certificate
  enable_s4u2self        = true    # Service for User to Self
  enable_s4u2proxy       = true    # Service for User to Proxy
}

# Load-balanced Kerberos configuration
resource "wallix-bastion_externalauth_kerberos" "load_balanced_kerberos" {
  auth_name       = "load_balanced_kerberos"
  display_name    = "Load Balanced Kerberos Authentication"
  realm           = "CLUSTER.COMPANY.COM"
  kdc_hostname    = "kdc-lb.company.com"  # Load balancer VIP
  kdc_port        = 88
  description     = "Load-balanced Kerberos authentication cluster"
  
  # Additional KDCs behind load balancer
  additional_kdcs = [
    {
      hostname = "kdc1.company.com"
      port     = 88
      weight   = 100
    },
    {
      hostname = "kdc2.company.com"
      port     = 88
      weight   = 100
    },
    {
      hostname = "kdc3.company.com"
      port     = 88
      weight   = 50   # Lower weight for backup
    }
  ]
  
  # Load balancing settings
  enable_failover        = true
  failover_timeout       = 5      # 5 seconds
  max_retries           = 3
  retry_delay           = 2       # 2 seconds
  
  # Health checking
  enable_health_check    = true
  health_check_interval  = 30     # 30 seconds
  health_check_timeout   = 5      # 5 seconds
  
  # Standard settings
  use_canonical_name     = true
  enable_forwardable     = true
  enable_renewable       = true
  
  # Encryption settings
  encryption_types = [
    "aes256-cts-hmac-sha1-96",
    "aes128-cts-hmac-sha1-96"
  ]
  
  # Optimized for high availability
  ticket_lifetime        = 21600   # 6 hours
  renewable_lifetime     = 432000  # 5 days
}

# Development Kerberos with relaxed security
resource "wallix-bastion_externalauth_kerberos" "dev_kerberos" {
  auth_name       = "dev_kerberos"
  display_name    = "Development Kerberos Authentication"
  realm           = "DEV.COMPANY.COM"
  kdc_hostname    = "dev-kdc.company.com"
  kdc_port        = 88
  description     = "Development Kerberos authentication with relaxed security for testing"
  
  # Development-friendly settings
  use_canonical_name     = false   # More permissive
  enable_forwardable     = true
  enable_renewable       = true
  enable_proxiable       = true
  
  # Relaxed encryption for testing
  encryption_types = [
    "aes256-cts-hmac-sha1-96",
    "aes128-cts-hmac-sha1-96",
    "des3-cbc-sha1",
    "rc4-hmac"
  ]
  
  # Allow weaker crypto for testing
  allow_weak_crypto      = true
  
  # Extended lifetimes for development
  ticket_lifetime        = 86400   # 24 hours
  renewable_lifetime     = 604800  # 7 days
  
  # Enhanced debugging
  enable_debug_logs      = true
  debug_level           = "verbose"
  log_kdc_communication = true
  
  # Development-specific features
  allow_anonymous_access = false   # Still secure
  enable_testing_mode   = true
  ignore_host_verification = false # Still verify hosts
}

# Kerberos with custom keytab
resource "wallix-bastion_externalauth_kerberos" "keytab_kerberos" {
  auth_name       = "keytab_kerberos"
  display_name    = "Keytab-based Kerberos Authentication"
  realm           = "SERVICE.COMPANY.COM"
  kdc_hostname    = "kdc.service.company.com"
  kdc_port        = 88
  description     = "Kerberos authentication using service keytab"
  
  # Service principal configuration
  service_principal   = "bastion/bastion.company.com@SERVICE.COMPANY.COM"
  keytab_file        = "/etc/krb5.keytab"
  
  # Keytab-specific settings
  use_keytab         = true
  validate_keytab    = true
  keytab_permissions = "600"  # Secure file permissions
  
  # Service authentication settings
  use_canonical_name     = true
  enable_forwardable     = false  # Services typically don't forward
  enable_renewable       = true
  
  # Service-appropriate encryption
  encryption_types = [
    "aes256-cts-hmac-sha1-96",
    "aes128-cts-hmac-sha1-96"
  ]
  
  # Service ticket lifetimes
  ticket_lifetime        = 43200   # 12 hours
  renewable_lifetime     = 86400   # 24 hours
  
  # Service monitoring
  enable_audit_logs      = true
  log_service_tickets    = true
  monitor_keytab_changes = true
}
```

{{ .SchemaMarkdown | trimspace }}

## Usage Notes

### Kerberos Authentication Overview

Kerberos external authentication enables integration with Kerberos Key Distribution Centers (KDCs) for secure, ticket-based authentication without transmitting passwords over the network.

### Basic Configuration

**Required Fields:**

- **auth_name**: Internal identifier for the Kerberos authentication
- **display_name**: Human-readable name displayed in interfaces
- **realm**: Kerberos realm (typically uppercase domain name)
- **kdc_hostname**: Primary KDC server hostname
- **kdc_port**: KDC port (typically 88)

### Realm Configuration

**Single Realm Setup:**

```terraform
realm        = "COMPANY.COM"
kdc_hostname = "kdc.company.com"
kdc_port     = 88
```

**Multi-KDC Setup:**

```terraform
kdc_hostname = "primary-kdc.company.com"
additional_kdcs = [
  {
    hostname = "backup-kdc.company.com"
    port     = 88
  }
]
```

**Cross-Realm Trust:**

```terraform
trusted_realms = [
  {
    realm        = "PARTNER.ORG"
    kdc_hostname = "kdc.partner.org"
    kdc_port     = 88
  }
]
enable_cross_realm = true
```

### Active Directory Integration

**Basic AD Configuration:**

```terraform
realm        = "AD.COMPANY.COM"
kdc_hostname = "dc1.ad.company.com"

# AD-specific settings
use_canonical_name = true
enable_forwardable = true
enable_renewable   = true

# Windows-compatible encryption
encryption_types = [
  "aes256-cts-hmac-sha1-96",
  "aes128-cts-hmac-sha1-96",
  "rc4-hmac"
]
```

**Multi-Domain Forest:**

```terraform
realm = "ROOT.COMPANY.COM"
trusted_realms = [
  {
    realm        = "CHILD.COMPANY.COM"
    kdc_hostname = "dc.child.company.com"
    kdc_port     = 88
  }
]
enable_cross_realm = true
forest_wide_trust  = true
```

### Security Configuration

**Encryption Types:**

```terraform
# High security (AES only)
encryption_types = [
  "aes256-cts-hmac-sha1-96"
]

# Standard security (AES + 3DES)
encryption_types = [
  "aes256-cts-hmac-sha1-96",
  "aes128-cts-hmac-sha1-96",
  "des3-cbc-sha1"
]

# Compatibility mode (includes RC4 for legacy)
encryption_types = [
  "aes256-cts-hmac-sha1-96",
  "aes128-cts-hmac-sha1-96",
  "rc4-hmac"
]
```

**Ticket Security:**

```terraform
# Secure ticket configuration
require_preauth     = true   # Require pre-authentication
enable_forwardable  = false  # Disable ticket forwarding
enable_renewable    = false  # Disable renewable tickets
require_mutual_auth = true   # Require mutual authentication
```

**Advanced Security Features:**

```terraform
# FAST (Flexible Authentication Secure Tunneling)
enable_pa_fx_fast = true

# Privilege Attribute Certificate validation
enable_pac_validation = true

# Service for User extensions
enable_s4u2self  = true
enable_s4u2proxy = true
```

### Ticket Lifetime Management

**Standard Lifetimes:**

```terraform
ticket_lifetime     = 36000   # 10 hours
renewable_lifetime  = 604800  # 7 days
```

**High-Security Lifetimes:**

```terraform
ticket_lifetime     = 14400   # 4 hours
renewable_lifetime  = 28800   # 8 hours
```

**Development Lifetimes:**

```terraform
ticket_lifetime     = 86400   # 24 hours
renewable_lifetime  = 604800  # 7 days
```

### Service Principal Configuration

**Service Authentication:**

```terraform
service_principal = "bastion/bastion.company.com@COMPANY.COM"
use_keytab       = true
keytab_file      = "/etc/krb5.keytab"
validate_keytab  = true
```

**Keytab Management:**

```terraform
keytab_file        = "/etc/krb5.keytab"
keytab_permissions = "600"
monitor_keytab_changes = true
```

### High Availability Configuration

**Load Balancing:**

```terraform
kdc_hostname = "kdc-lb.company.com"  # Load balancer VIP

additional_kdcs = [
  {
    hostname = "kdc1.company.com"
    port     = 88
    weight   = 100
  },
  {
    hostname = "kdc2.company.com"
    port     = 88
    weight   = 100
  }
]

enable_failover = true
failover_timeout = 5
max_retries     = 3
```

**Health Monitoring:**

```terraform
enable_health_check   = true
health_check_interval = 30
health_check_timeout  = 5
```

### Debugging and Troubleshooting

**Debug Configuration:**

```terraform
enable_debug_logs     = true
debug_level          = "verbose"
log_kdc_communication = true
```

**Common Issues and Solutions:**

1. **Clock Skew**: Ensure time synchronization between bastion and KDC
2. **DNS Resolution**: Verify KDC hostname resolution
3. **Firewall**: Ensure port 88 (TCP/UDP) is open
4. **Encryption Mismatch**: Verify supported encryption types
5. **Realm Case**: Ensure realm is uppercase

**Debugging Commands:**

```bash
# Test KDC connectivity
kinit username@REALM

# Check ticket status
klist

# Test service principal
kvno service/hostname@REALM
```

### Environment-Specific Configurations

**Production Environment:**

```terraform
# High security settings
require_preauth       = true
enable_forwardable    = false
encryption_types      = ["aes256-cts-hmac-sha1-96"]
ticket_lifetime       = 14400  # 4 hours
enable_debug_logs     = false
```

**Development Environment:**

```terraform
# Relaxed settings for testing
allow_weak_crypto     = true
enable_debug_logs     = true
ticket_lifetime       = 86400  # 24 hours
ignore_host_verification = false  # Still secure
```

**Testing Environment:**

```terraform
# Enhanced debugging
enable_debug_logs     = true
debug_level          = "verbose"
log_kdc_communication = true
enable_testing_mode  = true
```

### Integration Patterns

**LDAP Fallback:**

```terraform
# Primary Kerberos with LDAP fallback
resource "wallix-bastion_externalauth_kerberos" "primary" {
  # Kerberos configuration
}

resource "wallix-bastion_authdomain_ldap" "fallback" {
  # LDAP fallback configuration
}
```

**Multi-Factor Integration:**

```terraform
# Kerberos + RADIUS for MFA
resource "wallix-bastion_externalauth_kerberos" "kerberos" {
  # Kerberos first factor
}

resource "wallix-bastion_externalauth_radius" "mfa" {
  # RADIUS second factor
}
```

### Monitoring and Maintenance

**Key Metrics:**

- Authentication success/failure rates
- KDC response times
- Ticket lifetime utilization
- Cross-realm authentication frequency
- Keytab file integrity

**Maintenance Tasks:**

1. Regular keytab rotation
2. KDC certificate updates
3. Performance monitoring
4. Security audit reviews
5. Backup KDC validation

### Best Practices

**Security Best Practices:**

1. Use strong encryption algorithms (AES-256)
2. Implement short ticket lifetimes
3. Regular keytab rotation
4. Monitor for anomalous authentication patterns
5. Use FAST for enhanced security

**Operational Best Practices:**

1. Implement KDC redundancy
2. Monitor KDC health and performance
3. Regular time synchronization checks
4. Document realm trust relationships
5. Test failover scenarios

**Integration Best Practices:**

1. Coordinate with Active Directory teams
2. Document service principal requirements
3. Implement proper error handling
4. Test cross-realm functionality
5. Maintain consistent naming conventions

### Compliance Considerations

**Audit Requirements:**

```terraform
enable_audit_logs           = true
log_authentication_events   = true
log_service_tickets        = true
```

**Data Protection:**

- Secure keytab file storage
- Encrypted communication channels
- Regular access reviews
- Proper key management procedures

## Import

Kerberos external authentication can be imported using the auth_name, e.g.

```shell
terraform import wallix-bastion_externalauth_kerberos.corporate_kerberos "corporate_kerberos"
```